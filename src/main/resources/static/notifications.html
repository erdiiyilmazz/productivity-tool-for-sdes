<!DOCTYPE html>
<html>
<head>
    <title>Notifications</title>
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
</head>
<body>
    <h2>Notifications</h2>
    <div id="notifications"></div>

    <script>
        let stompClient = null;
        
        function connect() {
            const socket = new SockJS('http://localhost:8081/ws');
            stompClient = Stomp.over(socket);
            
            // Enable debug mode
            stompClient.debug = function(str) {
                console.log(str);
            };
            
            stompClient.connect({}, function(frame) {
                console.log('Connected: ' + frame);
                
                stompClient.subscribe('/topic/notifications', function(notification) {
                    const message = JSON.parse(notification.body);
                    const notificationDiv = document.getElementById('notifications');
                    const messageElement = document.createElement('div');
                    messageElement.textContent = message.content;
                    messageElement.className = 'notification-message';
                    notificationDiv.appendChild(messageElement);
                });
            }, function(error) {
                console.error('Connection error: ' + error);
                setTimeout(connect, 5000);
            });
        }

        connect();

        window.onbeforeunload = function() {
            if (stompClient !== null) {
                stompClient.disconnect();
            }
        };
    </script>

    <style>
        .notification-message {
            padding: 10px;
            margin: 5px;
            background-color: #f0f0f0;
            border-left: 4px solid #4CAF50;
            white-space: pre-line;
            font-family: system-ui, -apple-system, sans-serif;
        }
    </style>
</body>
</html> 